<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Dashboard</title>
    <style>
        :root {
            --bg-color: #f5f5f5;
            --card-bg-color: #ffffff;
            --text-color: #333333;
            --primary-color: #1976d2;
            --primary-light: #e3f2fd;
            --secondary-color: #9c27b0;
            --success-color: #2e7d32;
            --success-bg: #e8f5e9;
            --error-color: #c62828;
            --error-bg: #ffebee;
            --warning-color: #f57f17;
            --warning-bg: #fff8e1;
            --border-color: #eeeeee;
            --shadow-color: rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --card-bg-color: #1e1e1e;
            --text-color: #e0e0e0;
            --primary-color: #42a5f5;
            --primary-light: #0d47a1;
            --secondary-color: #ce93d8;
            --success-color: #4caf50;
            --success-bg: #1b5e20;
            --error-color: #ef5350;
            --error-bg: #b71c1c;
            --warning-color: #ffa726;
            --warning-bg: #e65100;
            --border-color: #333333;
            --shadow-color: rgba(0,0,0,0.3);
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .sidebar {
            width: 240px;
            background-color: var(--card-bg-color);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            box-shadow: 2px 0 5px var(--shadow-color);
            padding-top: 60px;
            transition: all 0.3s ease;
        }
        .sidebar-header {
            padding: 16px;
            font-weight: bold;
            font-size: 18px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .theme-toggle {
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary-light);
            color: var(--primary-color);
            width: 24px;
            height: 24px;
            font-size: 14px;
        }
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .sidebar-menu li {
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.2s ease;
        }
        .sidebar-menu li:hover {
            background-color: var(--primary-light);
        }
        .sidebar-menu li.active {
            background-color: var(--primary-light);
            color: var(--primary-color);
            border-left: 3px solid var(--primary-color);
        }
        .sidebar-menu li i {
            margin-right: 10px;
        }
        .main-content {
            margin-left: 240px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        .card {
            background-color: var(--card-bg-color);
            border-radius: 8px;
            box-shadow: 0 2px 4px var(--shadow-color);
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        .card-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status-chip {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status-up {
            background-color: var(--success-bg);
            color: var(--success-color);
        }
        .status-down {
            background-color: var(--error-bg);
            color: var(--error-color);
        }
        .status-warning {
            background-color: var(--warning-bg);
            color: var(--warning-color);
        }
        .progress-bar {
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            margin: 8px 0;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background-color: var(--primary-color);
        }
        .progress-bar-fill.warning {
            background-color: var(--warning-color);
        }
        .progress-bar-fill.danger {
            background-color: var(--error-color);
        }
        .button {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            margin-right: 8px;
            transition: all 0.2s ease;
        }
        .button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        .button-primary {
            background-color: var(--primary-color);
            color: white;
        }
        .button-success {
            background-color: var(--success-color);
            color: white;
        }
        .button-error {
            background-color: var(--error-color);
            color: white;
        }
        .button-warning {
            background-color: var(--warning-color);
            color: white;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            font-size: 18px;
        }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .toast.success {
            background-color: var(--success-color);
        }
        .toast.error {
            background-color: var(--error-color);
        }
        .toast.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading" style="display: none;">
        <div class="spinner"></div>
        <div>Processing...</div>
    </div>
    <div id="toast" class="toast"></div>
    <div class="sidebar">
        <div class="sidebar-header">
            AI Research Platform
            <div class="theme-toggle" id="theme-toggle" title="Toggle dark/light mode">üåì</div>
        </div>
        <ul class="sidebar-menu">
            <li class="active"><i>üìä</i> Dashboard</li>
            <li><i>üîß</i> Services</li>
            <li><i>üì•</i> Data Collection</li>
            <li><i>üîÑ</i> Data Processing</li>
            <li><i>üß†</i> ML Framework</li>
            <li><i>üìà</i> System Monitor</li>
            <li><i>‚öôÔ∏è</i> Settings</li>
        </ul>
    </div>
    
    <div class="main-content">
        <h1>Dashboard</h1>
        
        <div class="card">
            <div class="card-title">System Overview</div>
            <div class="grid">
                <div class="card">
                    <div>CPU Usage</div>
                    <h2>45.2%</h2>
                    <div class="progress-bar">
                        <div class="progress-bar-fill" style="width: 45.2%"></div>
                    </div>
                </div>
                <div class="card">
                    <div>Memory Usage</div>
                    <h2>68.7%</h2>
                    <div class="progress-bar">
                        <div class="progress-bar-fill" style="width: 68.7%"></div>
                    </div>
                </div>
                <div class="card">
                    <div>Disk Usage</div>
                    <h2>72.1%</h2>
                    <div class="progress-bar">
                        <div class="progress-bar-fill warning" style="width: 72.1%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">Service Status</div>
            <div>
                <div style="display: flex; justify-content: space-between; padding: 8px; background-color: #f5f5f5; margin-bottom: 8px; border-radius: 4px;">
                    <div style="display: flex; align-items: center;">
                        <span style="color: #2e7d32;">‚úì</span>
                        <span style="margin-left: 8px;">Data Crawler</span>
                    </div>
                    <span class="status-chip status-up">UP</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 8px; background-color: #f5f5f5; margin-bottom: 8px; border-radius: 4px;">
                    <div style="display: flex; align-items: center;">
                        <span style="color: #2e7d32;">‚úì</span>
                        <span style="margin-left: 8px;">Data Scraper</span>
                    </div>
                    <span class="status-chip status-up">UP</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 8px; background-color: #f5f5f5; margin-bottom: 8px; border-radius: 4px;">
                    <div style="display: flex; align-items: center;">
                        <span style="color: #2e7d32;">‚úì</span>
                        <span style="margin-left: 8px;">Data Preprocessor</span>
                    </div>
                    <span class="status-chip status-up">UP</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 8px; background-color: #f5f5f5; margin-bottom: 8px; border-radius: 4px;">
                    <div style="display: flex; align-items: center;">
                        <span style="color: #c62828;">‚úó</span>
                        <span style="margin-left: 8px;">Data Transformer</span>
                    </div>
                    <span class="status-chip status-down">DOWN</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 8px; background-color: #f5f5f5; margin-bottom: 8px; border-radius: 4px;">
                    <div style="display: flex; align-items: center;">
                        <span style="color: #2e7d32;">‚úì</span>
                        <span style="margin-left: 8px;">ML Trainer</span>
                    </div>
                    <span class="status-chip status-up">UP</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 8px; background-color: #f5f5f5; margin-bottom: 8px; border-radius: 4px;">
                    <div style="display: flex; align-items: center;">
                        <span style="color: #f57f17;">‚ö†</span>
                        <span style="margin-left: 8px;">ML Evaluator</span>
                    </div>
                    <span class="status-chip status-warning">WARNING</span>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">Recent Jobs</div>
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="text-align: left; border-bottom: 1px solid #eee;">
                        <th style="padding: 8px;">Job Name</th>
                        <th style="padding: 8px;">Service</th>
                        <th style="padding: 8px;">Status</th>
                        <th style="padding: 8px;">Timestamp</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 8px;">Web Crawl - News Sites</td>
                        <td style="padding: 8px;">data-crawler</td>
                        <td style="padding: 8px;"><span class="status-chip status-up">COMPLETED</span></td>
                        <td style="padding: 8px;">2025-04-28 12:30:45</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee; background-color: #f5f5f5;">
                        <td style="padding: 8px;">Data Preprocessing - Dataset A</td>
                        <td style="padding: 8px;">data-preprocessor</td>
                        <td style="padding: 8px;"><span class="status-chip" style="background-color: #e3f2fd; color: #1976d2;">RUNNING</span></td>
                        <td style="padding: 8px;">2025-04-28 13:15:22</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 8px;">Model Training - NLP Classifier</td>
                        <td style="padding: 8px;">ml-trainer</td>
                        <td style="padding: 8px;"><span class="status-chip" style="background-color: #f3e5f5; color: #7b1fa2;">QUEUED</span></td>
                        <td style="padding: 8px;">2025-04-28 13:45:10</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee; background-color: #f5f5f5;">
                        <td style="padding: 8px;">Data Scraping - E-commerce</td>
                        <td style="padding: 8px;">data-scraper</td>
                        <td style="padding: 8px;"><span class="status-chip status-down">FAILED</span></td>
                        <td style="padding: 8px;">2025-04-28 11:20:33</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px;">Model Evaluation - Image Classifier</td>
                        <td style="padding: 8px;">ml-evaluator</td>
                        <td style="padding: 8px;"><span class="status-chip status-up">COMPLETED</span></td>
                        <td style="padding: 8px;">2025-04-28 10:05:18</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Simple navigation
        document.querySelectorAll('.sidebar-menu li').forEach((item, index) => {
            item.addEventListener('click', () => {
                // Remove active class from all items
                document.querySelectorAll('.sidebar-menu li').forEach(i => {
                    i.classList.remove('active');
                });
                
                // Add active class to clicked item
                item.classList.add('active');
                
                // Update main content based on clicked item
                const mainContent = document.querySelector('.main-content');
                const pages = ['Dashboard', 'Services', 'Data Collection', 'Data Processing', 'ML Framework', 'System Monitor', 'Settings'];
                
                if (index < pages.length) {
                    // Set the page title
                    mainContent.querySelector('h1').textContent = pages[index];
                    
                    // Handle different pages
                    if (index === 0) { // Dashboard
                        // Set up the dashboard structure
                        mainContent.innerHTML = `
                            <h1>Dashboard</h1>
                            
                            <div class="card">
                                <div class="card-title">System Overview</div>
                                <div class="grid" id="system-overview">
                                    <div class="card">
                                        <div>CPU Usage</div>
                                        <h2>Loading...</h2>
                                        <div class="progress-bar">
                                            <div class="progress-bar-fill" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div>Memory Usage</div>
                                        <h2>Loading...</h2>
                                        <div class="progress-bar">
                                            <div class="progress-bar-fill" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div>Disk Usage</div>
                                        <h2>Loading...</h2>
                                        <div class="progress-bar">
                                            <div class="progress-bar-fill" style="width: 0%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-title">Service Status</div>
                                <div id="service-status">
                                    <p>Loading services...</p>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-title">Recent Jobs</div>
                                <div id="recent-jobs">
                                    <p>Loading jobs...</p>
                                </div>
                            </div>
                        `;
                        
                        // Fetch and update system information
                        fetchSystemInfo().then(systemInfo => {
                            if (systemInfo) {
                                const systemOverview = document.getElementById('system-overview');
                                if (systemOverview) {
                                    systemOverview.innerHTML = `
                                        <div class="card">
                                            <div>CPU Usage</div>
                                            <h2>${systemInfo.cpu.usage}%</h2>
                                            <div class="progress-bar">
                                                <div class="progress-bar-fill${parseFloat(systemInfo.cpu.usage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.cpu.usage}%"></div>
                                            </div>
                                        </div>
                                        <div class="card">
                                            <div>Memory Usage</div>
                                            <h2>${systemInfo.memory.usagePercentage}%</h2>
                                            <div class="progress-bar">
                                                <div class="progress-bar-fill${parseFloat(systemInfo.memory.usagePercentage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.memory.usagePercentage}%"></div>
                                            </div>
                                        </div>
                                        <div class="card">
                                            <div>Disk Usage</div>
                                            <h2>${systemInfo.disk.usagePercentage}%</h2>
                                            <div class="progress-bar">
                                                <div class="progress-bar-fill${parseFloat(systemInfo.disk.usagePercentage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.disk.usagePercentage}%"></div>
                                            </div>
                                        </div>
                                    `;
                                }
                            }
                        });
                        
                        // Fetch and update service status
                        fetchServices().then(services => {
                            const serviceStatus = document.getElementById('service-status');
                            if (serviceStatus && services.length > 0) {
                                let html = '';
                                
                                services.forEach(service => {
                                    const statusClass = service.status === 'UP' ? 'status-up' : 
                                                        service.status === 'DOWN' ? 'status-down' : 'status-warning';
                                    const iconColor = service.status === 'UP' ? '#2e7d32' : 
                                                      service.status === 'DOWN' ? '#c62828' : '#f57f17';
                                    const icon = service.status === 'UP' ? '‚úì' : 
                                                 service.status === 'DOWN' ? '‚úó' : '‚ö†';
                                    
                                    html += `
                                        <div style="display: flex; justify-content: space-between; padding: 8px; background-color: var(--bg-color); margin-bottom: 8px; border-radius: 4px;">
                                            <div style="display: flex; align-items: center;">
                                                <span style="color: ${iconColor};">${icon}</span>
                                                <span style="margin-left: 8px;">${service.name}</span>
                                            </div>
                                            <span class="status-chip ${statusClass}">${service.status}</span>
                                        </div>
                                    `;
                                });
                                
                                serviceStatus.innerHTML = html;
                            }
                        });
                        
                        // Fetch and update recent jobs
                        fetchJobs().then(jobs => {
                            const recentJobs = document.getElementById('recent-jobs');
                            if (recentJobs && jobs.length > 0) {
                                let html = `
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr style="text-align: left; border-bottom: 1px solid var(--border-color);">
                                                <th style="padding: 8px;">Job Name</th>
                                                <th style="padding: 8px;">Service</th>
                                                <th style="padding: 8px;">Status</th>
                                                <th style="padding: 8px;">Timestamp</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                `;
                                
                                jobs.forEach((job, index) => {
                                    const statusClass = job.status === 'COMPLETED' ? 'status-up' : 
                                                        job.status === 'FAILED' ? 'status-down' : 
                                                        job.status === 'RUNNING' ? '' : '';
                                    const statusStyle = job.status === 'RUNNING' ? 'background-color: #e3f2fd; color: #1976d2;' : 
                                                        job.status === 'QUEUED' ? 'background-color: #f3e5f5; color: #7b1fa2;' : '';
                                    
                                    html += `
                                        <tr style="border-bottom: 1px solid var(--border-color);${index % 2 === 1 ? ' background-color: var(--bg-color);' : ''}">
                                            <td style="padding: 8px;">${job.name}</td>
                                            <td style="padding: 8px;">${job.service}</td>
                                            <td style="padding: 8px;"><span class="status-chip ${statusClass}" ${statusStyle ? `style="${statusStyle}"` : ''}>${job.status}</span></td>
                                            <td style="padding: 8px;">${job.timestamp}</td>
                                        </tr>
                                    `;
                                });
                                
                                html += `
                                        </tbody>
                                    </table>
                                `;
                                
                                recentJobs.innerHTML = html;
                            }
                        });
                    } else if (index === 1) { // Services
                        // Set up the services page structure
                        mainContent.innerHTML = `
                            <h1>Services</h1>
                            <div class="card">
                                <div class="card-title">Service Management</div>
                                <div id="service-grid" class="grid">
                                    <p>Loading services...</p>
                                </div>
                            </div>
                        `;
                        
                        // Fetch and update services
                        fetchServices().then(services => {
                            const serviceGrid = document.getElementById('service-grid');
                            if (serviceGrid && services.length > 0) {
                                let html = '';
                                
                                services.forEach(service => {
                                    const serviceId = service.name.toLowerCase().replace(/\s+/g, '-');
                                    const statusClass = service.status === 'UP' ? 'status-up' : 
                                                        service.status === 'DOWN' ? 'status-down' : 'status-warning';
                                    
                                    html += `
                                        <div class="card">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                                <h3>${service.name}</h3>
                                                <span id="${serviceId}-status" class="status-chip ${statusClass}">${service.status}</span>
                                            </div>
                                            <p>${service.description}</p>
                                            <p><strong>Version:</strong> ${service.version}</p>
                                            <p><strong>Last Updated:</strong> ${service.lastUpdated}</p>
                                            <div style="margin-top: 15px;">
                                                ${service.status === 'UP' || service.status === 'WARNING' ? 
                                                    `<button class="button button-error" onclick="handleServiceAction('${serviceId}', 'stop')">Stop</button>
                                                     <button class="button button-warning" onclick="handleServiceAction('${serviceId}', 'restart')">Restart</button>` : 
                                                    `<button class="button button-success" onclick="handleServiceAction('${serviceId}', 'start')">Start</button>
                                                     <button class="button button-warning" onclick="handleServiceAction('${serviceId}', 'restart')">Restart</button>`
                                                }
                                            </div>
                                        </div>
                                    `;
                                });
                                
                                serviceGrid.innerHTML = html;
                            }
                        });
                    } else if (index === 5) { // System Monitor
                        // Set up the system monitor structure
                        mainContent.innerHTML = `
                            <h1>System Monitor</h1>
                            <div class="card">
                                <div class="card-title">System Information</div>
                                <div id="system-info">
                                    <p>Loading system information...</p>
                                </div>
                                <div class="card-title">Resource Usage</div>
                                <div id="resource-usage">
                                    <p>Loading resource usage...</p>
                                </div>
                            </div>
                        `;
                        
                        // Fetch and update system information
                        fetchSystemInfo().then(systemInfo => {
                            if (systemInfo) {
                                const systemInfoElement = document.getElementById('system-info');
                                const resourceUsageElement = document.getElementById('resource-usage');
                                
                                if (systemInfoElement) {
                                    systemInfoElement.innerHTML = `
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                            <div>
                                                <p><strong>CPU Model:</strong> ${systemInfo.cpu.model}</p>
                                                <p><strong>CPU Cores:</strong> ${systemInfo.cpu.cores}</p>
                                                <p><strong>Total Memory:</strong> ${systemInfo.memory.total}</p>
                                                <p><strong>Total Disk:</strong> ${systemInfo.disk.total}</p>
                                            </div>
                                            <div>
                                                <p><strong>System Uptime:</strong> ${systemInfo.os.uptime}</p>
                                                <p><strong>OS:</strong> ${systemInfo.os.distro} ${systemInfo.os.release}</p>
                                                <p><strong>Timezone:</strong> ${systemInfo.time.timezone}</p>
                                                <p><strong>Current Time:</strong> ${new Date(systemInfo.time.current).toLocaleString()}</p>
                                            </div>
                                        </div>
                                    `;
                                }
                                
                                if (resourceUsageElement) {
                                    resourceUsageElement.innerHTML = `
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                            <div>
                                                <p><strong>CPU Usage:</strong> ${systemInfo.cpu.usage}%</p>
                                                <div class="progress-bar">
                                                    <div class="progress-bar-fill${parseFloat(systemInfo.cpu.usage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.cpu.usage}%"></div>
                                                </div>
                                                <p><strong>Memory Usage:</strong> ${systemInfo.memory.usagePercentage}%</p>
                                                <div class="progress-bar">
                                                    <div class="progress-bar-fill${parseFloat(systemInfo.memory.usagePercentage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.memory.usagePercentage}%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <p><strong>Disk Usage:</strong> ${systemInfo.disk.usagePercentage}%</p>
                                                <div class="progress-bar">
                                                    <div class="progress-bar-fill${parseFloat(systemInfo.disk.usagePercentage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.disk.usagePercentage}%"></div>
                                                </div>
                                                <p><strong>Memory Used:</strong> ${systemInfo.memory.used} / ${systemInfo.memory.total}</p>
                                                <div class="progress-bar">
                                                    <div class="progress-bar-fill" style="width: ${systemInfo.memory.usagePercentage}%"></div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="margin-top: 20px;">
                                            <button class="button button-primary" onclick="refreshSystemInfo()">Refresh Data</button>
                                        </div>
                                    `;
                                }
                            }
                        });
                    } else {
                        // For Data Collection, Data Processing, ML Framework, and Settings
                        // Show placeholder content
                        mainContent.innerHTML = `
                            <h1>${pages[index]}</h1>
                            <div class="card">
                                <div style="text-align: center; padding: 40px;">
                                    <h2>This page is under development</h2>
                                    <p>${pages[index]} functionality will be implemented soon.</p>
                                </div>
                            </div>
                        `;
                    }
                }
            });
        });
        
        // API base URL
        const API_BASE_URL = 'http://localhost:3001/api';
        
        // Mock data for when the backend is not available
        const mockServices = [
            {
                name: 'Data Crawler',
                status: 'UP',
                description: 'Crawls websites and collects data',
                version: '1.2.0',
                lastUpdated: '2025-04-15 10:30:00'
            },
            {
                name: 'Data Scraper',
                status: 'UP',
                description: 'Scrapes data from websites',
                version: '1.1.5',
                lastUpdated: '2025-04-10 09:15:00'
            },
            {
                name: 'Data Preprocessor',
                status: 'UP',
                description: 'Preprocesses collected data',
                version: '1.0.8',
                lastUpdated: '2025-04-12 14:20:00'
            },
            {
                name: 'Data Transformer',
                status: 'DOWN',
                description: 'Transforms data into different formats',
                version: '1.3.2',
                lastUpdated: '2025-04-05 11:20:00'
            },
            {
                name: 'ML Trainer',
                status: 'UP',
                description: 'Trains machine learning models',
                version: '2.0.1',
                lastUpdated: '2025-04-20 16:45:00'
            },
            {
                name: 'ML Evaluator',
                status: 'WARNING',
                description: 'Evaluates machine learning models',
                version: '2.2.1',
                lastUpdated: '2025-04-18 13:40:00'
            }
        ];
        
        const mockSystemInfo = {
            cpu: {
                model: 'Intel Core i7-10700K',
                cores: 8,
                usage: '45.2'
            },
            memory: {
                total: '16.00 GB',
                used: '10.99 GB',
                usagePercentage: '68.7'
            },
            disk: {
                total: '512.00 GB',
                used: '369.15 GB',
                usagePercentage: '72.1'
            },
            os: {
                platform: 'win32',
                distro: 'Windows',
                release: '11',
                uptime: '5d 7h 22m'
            },
            time: {
                current: new Date().toISOString(),
                uptime: 456422,
                timezone: 'Europe/Rome'
            }
        };
        
        const mockJobs = [
            {
                name: 'Web Crawl - News Sites',
                service: 'data-crawler',
                status: 'COMPLETED',
                timestamp: '2025-04-28 12:30:45'
            },
            {
                name: 'Data Preprocessing - Dataset A',
                service: 'data-preprocessor',
                status: 'RUNNING',
                timestamp: '2025-04-28 13:15:22'
            },
            {
                name: 'Model Training - NLP Classifier',
                service: 'ml-trainer',
                status: 'QUEUED',
                timestamp: '2025-04-28 13:45:10'
            },
            {
                name: 'Data Scraping - E-commerce',
                service: 'data-scraper',
                status: 'FAILED',
                timestamp: '2025-04-28 11:20:33'
            },
            {
                name: 'Model Evaluation - Image Classifier',
                service: 'ml-evaluator',
                status: 'COMPLETED',
                timestamp: '2025-04-28 10:05:18'
            }
        ];
        
        // Function to fetch all services
        async function fetchServices() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE_URL}/services`);
                if (!response.ok) {
                    throw new Error('Failed to fetch services');
                }
                const services = await response.json();
                hideLoading();
                return services;
            } catch (error) {
                console.error('Error fetching services:', error);
                showToast('Backend server not available. Showing mock data.', 'warning');
                hideLoading();
                return mockServices;
            }
        }
        
        // Function to fetch system information
        async function fetchSystemInfo() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE_URL}/system`);
                if (!response.ok) {
                    throw new Error('Failed to fetch system information');
                }
                const systemInfo = await response.json();
                hideLoading();
                return systemInfo;
            } catch (error) {
                console.error('Error fetching system information:', error);
                showToast('Backend server not available. Showing mock data.', 'warning');
                hideLoading();
                return mockSystemInfo;
            }
        }
        
        // Function to fetch recent jobs
        async function fetchJobs() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE_URL}/jobs`);
                if (!response.ok) {
                    throw new Error('Failed to fetch jobs');
                }
                const jobs = await response.json();
                hideLoading();
                return jobs;
            } catch (error) {
                console.error('Error fetching jobs:', error);
                showToast('Backend server not available. Showing mock data.', 'warning');
                hideLoading();
                return mockJobs;
            }
        }
        
        // Function to handle service actions (start, stop, restart)
        async function handleServiceAction(serviceId, action) {
            showLoading();
            
            try {
                // Make API call to perform the action
                const response = await fetch(`${API_BASE_URL}/services/${serviceId}/${action}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Failed to ${action} service`);
                }
                
                const result = await response.json();
                
                // Update UI based on the action
                const statusElement = document.querySelector(`#${serviceId}-status`);
                if (statusElement) {
                    statusElement.textContent = result.service.status;
                    
                    if (result.service.status === 'UP') {
                        statusElement.className = 'status-chip status-up';
                        
                        // Update buttons
                        const buttonContainer = statusElement.closest('.card').querySelector('div[style*="margin-top: 15px"]');
                        if (buttonContainer) {
                            buttonContainer.innerHTML = `
                                <button class="button button-error" onclick="handleServiceAction('${serviceId}', 'stop')">Stop</button>
                                <button class="button button-warning" onclick="handleServiceAction('${serviceId}', 'restart')">Restart</button>
                            `;
                        }
                    } else if (result.service.status === 'DOWN') {
                        statusElement.className = 'status-chip status-down';
                        
                        // Update buttons
                        const buttonContainer = statusElement.closest('.card').querySelector('div[style*="margin-top: 15px"]');
                        if (buttonContainer) {
                            buttonContainer.innerHTML = `
                                <button class="button button-success" onclick="handleServiceAction('${serviceId}', 'start')">Start</button>
                                <button class="button button-warning" onclick="handleServiceAction('${serviceId}', 'restart')">Restart</button>
                            `;
                        }
                    } else if (result.service.status === 'WARNING') {
                        statusElement.className = 'status-chip status-warning';
                    }
                }
                
                showToast(`Service ${serviceId} ${action} successful`, 'success');
            } catch (error) {
                console.error(`Error ${action} service:`, error);
                showToast(error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // Theme toggle functionality
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Show toast notification
            showToast(`${newTheme.charAt(0).toUpperCase() + newTheme.slice(1)} mode activated`, 'success');
        }
        
        // Function to show toast notifications
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.className = toast.className.replace('show', '');
            }, 3000);
        }
        
        // Function to show loading overlay
        function showLoading() {
            document.getElementById('loading').style.display = 'flex';
        }
        
        // Function to hide loading overlay
        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }
        
        // Function to refresh system information
        async function refreshSystemInfo() {
            const systemInfoElement = document.getElementById('system-info');
            const resourceUsageElement = document.getElementById('resource-usage');
            
            if (systemInfoElement) {
                systemInfoElement.innerHTML = '<p>Refreshing system information...</p>';
            }
            
            if (resourceUsageElement) {
                resourceUsageElement.innerHTML = '<p>Refreshing resource usage...</p>';
            }
            
            const systemInfo = await fetchSystemInfo();
            
            if (systemInfo) {
                if (systemInfoElement) {
                    systemInfoElement.innerHTML = `
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                            <div>
                                <p><strong>CPU Model:</strong> ${systemInfo.cpu.model}</p>
                                <p><strong>CPU Cores:</strong> ${systemInfo.cpu.cores}</p>
                                <p><strong>Total Memory:</strong> ${systemInfo.memory.total}</p>
                                <p><strong>Total Disk:</strong> ${systemInfo.disk.total}</p>
                            </div>
                            <div>
                                <p><strong>System Uptime:</strong> ${systemInfo.os.uptime}</p>
                                <p><strong>OS:</strong> ${systemInfo.os.distro} ${systemInfo.os.release}</p>
                                <p><strong>Timezone:</strong> ${systemInfo.time.timezone}</p>
                                <p><strong>Current Time:</strong> ${new Date(systemInfo.time.current).toLocaleString()}</p>
                            </div>
                        </div>
                    `;
                }
                
                if (resourceUsageElement) {
                    resourceUsageElement.innerHTML = `
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <p><strong>CPU Usage:</strong> ${systemInfo.cpu.usage}%</p>
                                <div class="progress-bar">
                                    <div class="progress-bar-fill${parseFloat(systemInfo.cpu.usage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.cpu.usage}%"></div>
                                </div>
                                <p><strong>Memory Usage:</strong> ${systemInfo.memory.usagePercentage}%</p>
                                <div class="progress-bar">
                                    <div class="progress-bar-fill${parseFloat(systemInfo.memory.usagePercentage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.memory.usagePercentage}%"></div>
                                </div>
                            </div>
                            <div>
                                <p><strong>Disk Usage:</strong> ${systemInfo.disk.usagePercentage}%</p>
                                <div class="progress-bar">
                                    <div class="progress-bar-fill${parseFloat(systemInfo.disk.usagePercentage) > 70 ? ' warning' : ''}" style="width: ${systemInfo.disk.usagePercentage}%"></div>
                                </div>
                                <p><strong>Memory Used:</strong> ${systemInfo.memory.used} / ${systemInfo.memory.total}</p>
                                <div class="progress-bar">
                                    <div class="progress-bar-fill" style="width: ${systemInfo.memory.usagePercentage}%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="button button-primary" onclick="refreshSystemInfo()">Refresh Data</button>
                        </div>
                    `;
                }
                
                showToast('System information refreshed', 'success');
            }
        }
        
        // Initialize the dashboard view
        document.addEventListener('DOMContentLoaded', function() {
            // Apply saved theme if exists
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            }
            
            // Add theme toggle event listener
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            
            // Trigger click on Dashboard menu item to show dashboard content
            document.querySelector('.sidebar-menu li:first-child').click();
            
            // Add IDs to service status elements for easier targeting
            document.querySelectorAll('.card h3').forEach(heading => {
                const serviceId = heading.textContent.toLowerCase().replace(/\s+/g, '-');
                const statusChip = heading.nextElementSibling;
                if (statusChip && statusChip.classList.contains('status-chip')) {
                    statusChip.id = `${serviceId}-status`;
                }
            });
        });
    </script>
</body>
</html>
